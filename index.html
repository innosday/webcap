<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¼ì¦ˆë² ë¦¬íŒŒì´ ì»¨íŠ¸ë¡¤ëŸ¬</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; text-align: center; background-color: #f0f0f0; margin: 0; padding-top: 50px; }
        
        /* ì˜ìƒ ìŠ¤íƒ€ì¼ */
        img { border: 3px solid #333; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); max-width: 90%; }
        
        /* ë²„íŠ¼ ì»¨í…Œì´ë„ˆ */
        .controls { margin-top: 20px; display: flex; justify-content: center; gap: 15px; }
        
        /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
        button {
            padding: 15px 25px; font-size: 18px; border: none; border-radius: 8px; cursor: pointer;
            color: white; font-weight: bold; transition: 0.2s;
        }
        button:active { transform: scale(0.95); }

        /* ê°œë³„ ë²„íŠ¼ ìƒ‰ìƒ */
        .btn-capture { background-color: #007bff; } /* íŒŒë‘ */
        .btn-on { background-color: #28a745; }      /* ì´ˆë¡ */
        .btn-off { background-color: #6c757d; }     /* íšŒìƒ‰ */
        
        /* ìš°ì¸¡ ìƒë‹¨ ì¢…ë£Œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-exit {
            position: absolute; top: 20px; right: 20px;
            background-color: #dc3545; /* ë¹¨ê°• */
            width: 50px; height: 50px; font-size: 24px; padding: 0;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .btn-exit:hover { background-color: #c82333; }

        #log { margin-top: 20px; font-size: 18px; font-weight: bold; color: #333; }
    </style>
</head>
<body>

    <button class="btn-exit" onclick="sendAction('shutdown')" title="ì„œë²„ ì¢…ë£Œ">X</button>

    <h1>ğŸ“¡ ë¼ì¦ˆë² ë¦¬íŒŒì´ ê´€ì œ ì„¼í„°</h1>

    <img src="http://172.30.3.44:8000/video_feed" alt="Camera Stream">
    
    <div class="controls">
        <button class="btn-capture" onclick="sendAction('capture')">ğŸ“· ì‚¬ì§„ ì´¬ì˜</button>
        <button class="btn-on" onclick="sendAction('led_on')">ğŸ’¡ LED ì¼œê¸°</button>
        <button class="btn-off" onclick="sendAction('led_off')">ğŸŒ‘ LED ë„ê¸°</button>
    </div>

    <p id="log">ëŒ€ê¸° ì¤‘...</p>

    <script>
        // ì¤‘ìš”: ë¼ì¦ˆë² ë¦¬íŒŒì´ IPë¡œ ë³€ê²½í•˜ì„¸ìš”!
        const PI_API_URL = "http://172.30.3.44:8000/action";

        async function sendAction(commandType) {
            const logElement = document.getElementById("log");
            
            if (commandType === 'shutdown') {
                if (!confirm("ì •ë§ ë¼ì¦ˆë² ë¦¬íŒŒì´ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            }

            try {
                const response = await fetch(PI_API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ command: commandType })
                });
                
                const result = await response.json();
                
                if (result.status === 'shutdown') {
                    logElement.innerText = "â›” ì„œë²„ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
                    logElement.style.color = "red";
                    // ì˜ìƒ ì´ë¯¸ì§€ ê¹¨ì§ ë°©ì§€ë¥¼ ìœ„í•´ ì´ë¯¸ì§€ ìˆ¨ê¸°ê¸° (ì„ íƒ)
                    document.querySelector("img").style.opacity = "0.5";
                } else {
                    logElement.innerText = "âœ… " + result.message;
                    logElement.style.color = "green";
                }

            } catch (error) {
                console.error("ì—ëŸ¬ ë°œìƒ:", error);
                logElement.innerText = "âš ï¸ ì—°ê²° ì‹¤íŒ¨ (ì„œë²„ê°€ êº¼ì ¸ìˆë‚˜ìš”?)";
                logElement.style.color = "orange";
            }
        }
    </script>

</body>
</html>
